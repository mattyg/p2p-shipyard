var e,t,i,r=4294967295;function n(e,t,i){var r=Math.floor(i/4294967296),n=i;e.setUint32(t,r),e.setUint32(t+4,n)}var o=("undefined"==typeof process||"never"!==(null===(e=null===process||void 0===process?void 0:process.env)||void 0===e?void 0:e.TEXT_ENCODING))&&"undefined"!=typeof TextEncoder&&"undefined"!=typeof TextDecoder;function s(e){for(var t=e.length,i=0,r=0;r<t;){var n=e.charCodeAt(r++);if(4294967168&n)if(4294965248&n){if(n>=55296&&n<=56319&&r<t){var o=e.charCodeAt(r);56320==(64512&o)&&(++r,n=((1023&n)<<10)+(1023&o)+65536)}i+=4294901760&n?4:3}else i+=2;else i++}return i}var c=o?new TextEncoder:void 0,a=o?"undefined"!=typeof process&&"force"!==(null===(t=null===process||void 0===process?void 0:process.env)||void 0===t?void 0:t.TEXT_ENCODING)?200:0:r;var h=(null==c?void 0:c.encodeInto)?function(e,t,i){c.encodeInto(e,t.subarray(i))}:function(e,t,i){t.set(c.encode(e),i)};o&&new TextDecoder,o&&"undefined"!=typeof process&&(null===(i=null===process||void 0===process?void 0:process.env)||void 0===i||i.TEXT_DECODER);var f,u=function(e,t){this.type=e,this.data=t},p=(f=function(e,t){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},f(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),w=function(e){function t(i){var r=e.call(this,i)||this,n=Object.create(t.prototype);return Object.setPrototypeOf(r,n),Object.defineProperty(r,"name",{configurable:!0,enumerable:!1,value:t.name}),r}return p(t,e),t}(Error),d=4294967295,l=17179869183;var y={type:-1,encode:function(e){var t,i,r,o;return e instanceof Date?function(e){var t,i=e.sec,r=e.nsec;if(i>=0&&r>=0&&i<=l){if(0===r&&i<=d){var o=new Uint8Array(4);return(t=new DataView(o.buffer)).setUint32(0,i),o}var s=i/4294967296,c=4294967295&i;return o=new Uint8Array(8),(t=new DataView(o.buffer)).setUint32(0,r<<2|3&s),t.setUint32(4,c),o}return o=new Uint8Array(12),(t=new DataView(o.buffer)).setUint32(0,r),n(t,4,i),o}((t=e.getTime(),i=Math.floor(t/1e3),r=1e6*(t-1e3*i),o=Math.floor(r/1e9),{sec:i+o,nsec:r-1e9*o})):null},decode:function(e){var t=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return{sec:r=t.getUint32(0),nsec:0};case 8:var i=t.getUint32(0);return{sec:r=4294967296*(3&i)+t.getUint32(4),nsec:i>>>2};case 12:var r=function(e,t){return 4294967296*e.getInt32(t)+e.getUint32(t+4)}(t,4);return{sec:r,nsec:t.getUint32(0)};default:throw new w("Unrecognized data size for timestamp (expected 4, 8, or 12): ".concat(e.length))}}(e);return new Date(1e3*t.sec+t.nsec/1e6)}},v=function(){function e(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(y)}return e.prototype.register=function(e){var t=e.type,i=e.encode,r=e.decode;if(t>=0)this.encoders[t]=i,this.decoders[t]=r;else{var n=1+t;this.builtInEncoders[n]=i,this.builtInDecoders[n]=r}},e.prototype.tryToEncode=function(e,t){for(var i=0;i<this.builtInEncoders.length;i++){if(null!=(r=this.builtInEncoders[i]))if(null!=(n=r(e,t)))return new u(-1-i,n)}for(i=0;i<this.encoders.length;i++){var r,n;if(null!=(r=this.encoders[i]))if(null!=(n=r(e,t)))return new u(i,n)}return e instanceof u?e:null},e.prototype.decode=function(e,t,i){var r=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return r?r(e,t,i):new u(t,e)},e.defaultCodec=new e,e}();var U=function(){function e(e,t,i,r,n,o,s,c){void 0===e&&(e=v.defaultCodec),void 0===t&&(t=void 0),void 0===i&&(i=100),void 0===r&&(r=2048),void 0===n&&(n=!1),void 0===o&&(o=!1),void 0===s&&(s=!1),void 0===c&&(c=!1),this.extensionCodec=e,this.context=t,this.maxDepth=i,this.initialBufferSize=r,this.sortKeys=n,this.forceFloat32=o,this.ignoreUndefined=s,this.forceIntegerToFloat=c,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return e.prototype.reinitializeState=function(){this.pos=0},e.prototype.encodeSharedRef=function(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)},e.prototype.encode=function(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)},e.prototype.doEncode=function(e,t){if(t>this.maxDepth)throw new Error("Too deep objects in depth ".concat(t));null==e?this.encodeNil():"boolean"==typeof e?this.encodeBoolean(e):"number"==typeof e?this.encodeNumber(e):"string"==typeof e?this.encodeString(e):this.encodeObject(e,t)},e.prototype.ensureBufferSizeToWrite=function(e){var t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(2*t)},e.prototype.resizeBuffer=function(e){var t=new ArrayBuffer(e),i=new Uint8Array(t),r=new DataView(t);i.set(this.bytes),this.view=r,this.bytes=i},e.prototype.encodeNil=function(){this.writeU8(192)},e.prototype.encodeBoolean=function(e){!1===e?this.writeU8(194):this.writeU8(195)},e.prototype.encodeNumber=function(e){Number.isSafeInteger(e)&&!this.forceIntegerToFloat?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):(this.writeU8(211),this.writeI64(e)):this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))},e.prototype.writeStringHeader=function(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else{if(!(e<4294967296))throw new Error("Too long string: ".concat(e," bytes in UTF-8"));this.writeU8(219),this.writeU32(e)}},e.prototype.encodeString=function(e){if(e.length>a){var t=s(e);this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),h(e,this.bytes,this.pos),this.pos+=t}else{t=s(e);this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),function(e,t,i){for(var r=e.length,n=i,o=0;o<r;){var s=e.charCodeAt(o++);if(4294967168&s){if(4294965248&s){if(s>=55296&&s<=56319&&o<r){var c=e.charCodeAt(o);56320==(64512&c)&&(++o,s=((1023&s)<<10)+(1023&c)+65536)}4294901760&s?(t[n++]=s>>18&7|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128):(t[n++]=s>>12&15|224,t[n++]=s>>6&63|128)}else t[n++]=s>>6&31|192;t[n++]=63&s|128}else t[n++]=s}}(e,this.bytes,this.pos),this.pos+=t}},e.prototype.encodeObject=function(e,t){var i=this.extensionCodec.tryToEncode(e,this.context);if(null!=i)this.encodeExtension(i);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else{if("object"!=typeof e)throw new Error("Unrecognized object: ".concat(Object.prototype.toString.apply(e)));this.encodeMap(e,t)}},e.prototype.encodeBinary=function(e){var t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large binary: ".concat(t));this.writeU8(198),this.writeU32(t)}var i,r=(i=e)instanceof Uint8Array?i:ArrayBuffer.isView(i)?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i instanceof ArrayBuffer?new Uint8Array(i):Uint8Array.from(i);this.writeU8a(r)},e.prototype.encodeArray=function(e,t){var i=e.length;if(i<16)this.writeU8(144+i);else if(i<65536)this.writeU8(220),this.writeU16(i);else{if(!(i<4294967296))throw new Error("Too large array: ".concat(i));this.writeU8(221),this.writeU32(i)}for(var r=0,n=e;r<n.length;r++){var o=n[r];this.doEncode(o,t+1)}},e.prototype.countWithoutUndefined=function(e,t){for(var i=0,r=0,n=t;r<n.length;r++){void 0!==e[n[r]]&&i++}return i},e.prototype.encodeMap=function(e,t){var i=Object.keys(e);this.sortKeys&&i.sort();var r=this.ignoreUndefined?this.countWithoutUndefined(e,i):i.length;if(r<16)this.writeU8(128+r);else if(r<65536)this.writeU8(222),this.writeU16(r);else{if(!(r<4294967296))throw new Error("Too large map object: ".concat(r));this.writeU8(223),this.writeU32(r)}for(var n=0,o=i;n<o.length;n++){var s=o[n],c=e[s];this.ignoreUndefined&&void 0===c||(this.encodeString(s),this.doEncode(c,t+1))}},e.prototype.encodeExtension=function(e){var t=e.data.length;if(1===t)this.writeU8(212);else if(2===t)this.writeU8(213);else if(4===t)this.writeU8(214);else if(8===t)this.writeU8(215);else if(16===t)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large extension object: ".concat(t));this.writeU8(201),this.writeU32(t)}this.writeI8(e.type),this.writeU8a(e.data)},e.prototype.writeU8=function(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++},e.prototype.writeU8a=function(e){var t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t},e.prototype.writeI8=function(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++},e.prototype.writeU16=function(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2},e.prototype.writeI16=function(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2},e.prototype.writeU32=function(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4},e.prototype.writeI32=function(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4},e.prototype.writeF32=function(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4},e.prototype.writeF64=function(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8},e.prototype.writeU64=function(e){this.ensureBufferSizeToWrite(8),function(e,t,i){var r=i/4294967296,n=i;e.setUint32(t,r),e.setUint32(t+4,n)}(this.view,this.pos,e),this.pos+=8},e.prototype.writeI64=function(e){this.ensureBufferSizeToWrite(8),n(this.view,this.pos,e),this.pos+=8},e}(),_={};function g(e,t,i){window.__HC_LAUNCHER_ENV__={APP_INTERFACE_PORT:t,INSTALLED_APP_ID:e,APP_INTERFACE_TOKEN:i},window.__HC_ZOME_CALL_SIGNER__={signZomeCall:async e=>{const t=Uint8Array.from(await crypto.getRandomValues(new Uint8Array(32))),i=1e3*(Date.now()+3e5),r=Array.from((n=e.payload,void 0===o&&(o=_),new U(o.extensionCodec,o.context,o.maxDepth,o.initialBufferSize,o.sortKeys,o.forceFloat32,o.ignoreUndefined,o.forceIntegerToFloat).encodeSharedRef(n)));var n,o;const s={provenance:e.provenance,cellIdDnaHash:e.cell_id[0],cellIdAgentPubKey:e.cell_id[1],zomeName:e.zome_name,fnName:e.fn_name,capSecret:null,payload:r,nonce:t,expiresAt:i},c=await window.__TAURI_INTERNALS__.invoke("plugin:holochain-service-consumer|sign_zome_call",s);return{provenance:e.provenance,cell_id:e.cell_id,zome_name:e.zome_name,fn_name:e.fn_name,cap_secret:null,payload:r,nonce:t,expires_at:i,signature:Uint8Array.from(c.signature)}}}}window.injectHolochainClientEnv=g,window.setupApp=async function(e,t,i){if("http://tauri.localhost"!==window.location.origin)return;const{installed:r}=await window.__TAURI_INTERNALS__.invoke("plugin:holochain-service-consumer|is_app_installed",{appId:e});r||await window.__TAURI_INTERNALS__.invoke("plugin:holochain-service-consumer|install_app",{appId:e,appBundleBytes:t,membraneProofs:{},networkSeed:i});const{port:n,token:o}=await window.__TAURI_INTERNALS__.invoke("plugin:holochain-service-consumer|app_websocket_auth",{appId:e});g(e,n,o)};
